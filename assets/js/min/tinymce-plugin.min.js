!function(){tinymce.create("tinymce.plugins.anspress",{init:function(a,b){a.on("SaveContent",function(a){a.content=a.content.replace(/<img([^>]+data-apimagename.*?[\w\W]+?)\/>/g,function(a,b){return regex=/data-apimagename\=\"([\S+]*)\"/g,apimagename=regex.exec(a),regex=/alt\=\"([\S+]*)\"/g,alt=regex.exec(a),'{{apimage "'+apimagename[1]+'" "'+alt[1]+'"}}'})}),a.addButton("apmedia",{title:"Insert image",icon:"image",onclick:function(){var b=a.windowManager.open({title:"Insert Media (AnsPress)",resizable:!0,scrollbars:!0,width:500,height:300,buttons:[{text:"Insert",subtype:"primary",onclick:function(){var c=b.find("#image-preview")[0].$el.context,d=b.find("#file-title")[0].$el.context;a.insertContent('<img src="'+jQuery(c).find("img").attr("src")+'" alt="'+jQuery(d).val()+'" data-apimagename="'+jQuery(c).find("img").attr("data-apimagename")+'" />'),b.close()}},{text:"Close",onclick:function(){b.close()}}],body:[{type:"button",name:"file-browser",label:"Select File",text:"Browse from computer",onclick:function(c){$ta_name=jQuery(a.getElement()).attr("id")+"-images[]";var d=jQuery('<input name="'+$ta_name+'" type="file" accept="image/*" />').hide();d.insertAfter(a.getElement()),d.on("change",function(a){var c=this;if(this.files&&this.files[0]){var d=new FileReader;d.onload=function(a){var d=b.find("#image-preview")[0].$el.context;jQuery(d).html('<div class="ap-image-prev" style="position: relative"><img style="height: 150px;width: auto;max-width: 100%" src="'+a.target.result+'" data-apimagename="'+c.files[0].name+'" /></div>')},d.readAsDataURL(this.files[0])}}),d.click()}},{type:"textbox",name:"file-title",label:"Image title",minWidth:300},{type:"container",name:"image-preview",label:"Media preview"}]})}})},createControl:function(a,b){return null}}),tinymce.PluginManager.add("anspress",tinymce.plugins.anspress)}();
//# sourceMappingURL=tinymce-plugin.min.js.map