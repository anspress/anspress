function apAjaxData(a){return a+="&action=ap_ajax"}function apQueryStringToJSON(a){var b=a.split("&"),c={};return b.forEach(function(a){a=a.split("="),c[a[0]]=encodeURIComponent(a[1]||"")}),JSON.parse(JSON.stringify(c))}function apGetValueFromStr(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+b+"=([^&#]*)"),d=c.exec(a);return null==d?!1:decodeURIComponent(d[1].replace(/\+/g," "))}function apCenterBox(a){var a=jQuery(a),b=a.parent();b.css({position:"relative"}),a.css("left",(b.width()-a.width())/2),a.css("top",(b.height()-a.height())/2)}!function(a){a(function(){AnsPress.site=new AnsPress.site,AnsPress.site.initialize()}),window.AnsPress={},AnsPress.site=function(){},AnsPress.site.prototype={initialize:function(){ApSite=this,this.ajax_id=new Object,this.loading=new Object,this.errors,this.ajaxData,this.appendFormError(),this.appendMessageBox(),this.ap_comment_form(),this.afterPostingAnswer(),this.ap_ajax_form(),this.load_comment_form(),this.delete_comment(),this.ap_subscribe(),this.vote(),this.select_answer(),this.ap_delete_post(),this.ap_upload_field(),this.change_status(),this.load_profile_field(),this.ap_post_upload_field(),this.tinyMCEeditorToggle(),this.tab(),this.set_featured(),this.modal(),this.expand(),this.follow(),this.updateCover(),this.hoverCard(),this.delete_notification(),this.mark_as_read(),this.cancel_comment()},doAjax:function(b,c,d,e,f){d="undefined"!=typeof d?d:!1,c="undefined"!=typeof c?c:!1,e="undefined"!=typeof e?e:!1,f="undefined"!=typeof f?f:!1;var g=apGetValueFromStr(b,"ap_ajax_action");f&&"undefined"!=typeof ApSite.ajax_id[g]&&ApSite.ajax_id[g].abort();var h=a.ajax({type:"POST",url:ajaxurl,data:b,beforeSend:e,success:c,dataType:"json",context:d,global:!0,cache:!1});return ApSite.ajax_id[g]=h,h},doAction:function(b){var c=this,b="undefined"!=typeof b?'[data-action="'+b+'"]':"[data-action]",d=new Object;a(b).each(function(b){var e=a(this).attr("data-action");"undefined"==typeof d[e]&&(d[e]="1",c[e]('[data-action="'+e+'"]'))})},uniqueId:function(){return a(".ap-uid").length},showLoading:function(b){AnsPress.site.hideLoading(b);var c=this.uniqueId(),d=a('<div class="ap-loading-icon ap-uid" id="apuid-'+c+'"><i class="apicon-sync"><i></div>');a("body").append(d);var e=a(b).offset(),f=a(b).outerHeight(),g=a(b).outerWidth();return d.css(a(b).is('a, button, input[type="submit"], form')?{top:e.top,left:e.left,height:f,width:g}:{top:e.top+14,left:e.left+g-20}),a(b).data("loading","#apuid-"+c),"#apuid-"+c},hideLoading:function(b){a(a(b).data("loading")).hide()},suggest_similar_questions:function(){a('[data-action="suggest_similar_questions"]').on("keyup keydown",function(){""!=a.trim(a(this).val())&&ApSite.doAjax(apAjaxData("ap_ajax_action=suggest_similar_questions&value="+a(this).val()),function(b){"undefined"!=typeof b.html&&a("#similar_suggestions").html(b.html)},this,!1,!0)})},ap_ajax_form:function(){a("body").delegate('[data-action="ap_ajax_form"]',"submit",function(){return AnsPress.site.showLoading(this),a(this).append('<input type="hidden" name="ap_ajax_action" value="'+a(this).attr("name")+'">'),a(this).append('<input type="hidden" name="action" value="ap_ajax">'),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),a(this).ajaxSubmit({type:"POST",url:ajaxurl,success:function(a){AnsPress.site.hideLoading(this),"undefined"!=typeof tinyMCE&&"undefined"!=typeof a.type&&"success"==a.type&&tinyMCE.activeEditor.setContent("")},error:function(a,b,c){console.log(c),AnsPress.site.hideLoading(this),AnsPress.site.addMessage(aplang.not_valid_response,"error")},dataType:"json",context:this,global:!0,cache:!1}),!1})},appendFormError:function(){a(document).on("ap_after_ajax",function(b,c){"undefined"!=typeof c.errors&&(ApSite.clearFormErrors(c.form),a.each(c.errors,function(b,d){var e=a("#"+c.form).find("#"+b).closest(".ap-form-fields");e.addClass("ap-have-error"),ApSite.helpBlock(e,d)}))})},helpBlock:function(b,c){a(b).find(".ap-form-error-message").length>0&&a(b).find(".ap-form-error-message").remove(),a(b).append('<p class="ap-form-error-message">'+c+"</p>")},clearFormErrors:function(b){var c=a("#"+b).find(".ap-have-error");c.find(".ap-form-error-message").remove(),c.removeClass("ap-have-error")},appendMessageBox:function(){"0"==a("#ap-notify").length&&a("body").append('<div id="ap-notify"></div>')},addMessage:function(b,c){var d=aplang[c];a('<div class="ap-notify-item '+c+'"><i class="'+d+'"></i><div class="ap-notify-content">'+b+"</div></div>").appendTo("#ap-notify").animate({"margin-left":0},500).delay(5e3).fadeOut(200)},redirect:function(a){"undefined"!=typeof a.redirect_to&&window.location.replace(a.redirect_to)},reload:function(a){location.reload()},append:function(b){"undefined"!=typeof b.container&&a(b.container).append(b.html)},updateText:function(b){"undefined"!=typeof b.container&&a(b.container).text(b.text)},replaceWith:function(b){"undefined"!=typeof b.container&&a(b.container).replaceWith(b.html)},updateHtml:function(b){"undefined"!=typeof b.container&&a(b.container).html(b.html)},toggle_active_class:function(b){"undefined"!=typeof b.toggle_active_class_container&&(a(b.toggle_active_class_container).find("li").removeClass("active"),a(b.toggle_active_class_container).find(b.active).addClass("active"))},append_before:function(b){"undefined"!=typeof b.append_before_container&&a(b.append_before_container).before(b.html)},remove_if_exists:function(b){"undefined"!=typeof b.remove_if_exists_container&&a(b.remove_if_exists_container).length>0&&a(b.remove_if_exists_container).remove()},clearForm:function(a){"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor.setContent("")},scrollToCommentForm:function(){a("#ap-commentform").length>0&&a("html, body").animate({scrollTop:a("#ap-commentform").offset().top-150},500)},load_comment_form:function(){a("body").delegate('[data-action="load_comment_form"]',"click",function(b){if(b.preventDefault(),a(this).is(".loaded"))ApSite.scrollToCommentForm();else{ApSite.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){ApSite.hideLoading(this);var c=a(this);if(a(this).addClass("loaded"),b.view_default)a(b.container).append(b.html);else if(a(b.html).is(".ap-comment-block")){var d=c.closest(".ap-q-inner");d.find(".ap-comment-block").remove(),d.append(b.html)}else a(".ap-comment-form").remove(),a(this).closest(".ap-q-inner").append(b.html);ApSite.scrollToCommentForm(),jQuery("textarea.autogrow, textarea#post_content").keyup(),"undefined"!=typeof c.attr("data-toggle")&&a(c.attr("data-toggle")).hide(),a("#ap-comment-textarea").focus(),a(c.attr("href")).addClass("have-comments").removeClass("no-comment")},this,!1,!0)}})},ap_comment_form:function(){a("body").delegate("#ap-commentform","submit",function(){return ApSite.showLoading(this),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),ApSite.doAjax(apAjaxData(a(this).formSerialize()),function(b){ApSite.hideLoading(this),"new_comment"==b.action&&"success"==b.message_type?a("#comments-"+b.comment_post_ID+" ul.ap-commentlist").append(a(b.html).hide().slideDown(100)):"edit_comment"==b.action&&"success"==b.message_type&&(a("#li-comment-"+b.comment_ID+" .ap-comment-texts").html(b.html),a("#li-comment-"+b.comment_ID).slideDown(400),a(".ap-comment-form").remove()),a(".ap-comment-form").fadeOut(200,function(){a(this).remove()}),a('a[href="#comments-'+b.comment_post_ID+'"]').removeClass("loaded")},this),!1})},delete_comment:function(){a("body").delegate('[data-action="delete_comment"]',"click",function(b){b.preventDefault();var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){"undefined"!=typeof a(this).attr("data-toggle")&&"success"==b.message_type&&a(a(this).attr("data-toggle")).hide()},this,!1,!0)})},ap_subscribe:function(){a('[data-action="ap_subscribe"]').click(function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){AnsPress.site.hideLoading(this),"subscribed"==b.action?(a(this).addClass("active"),a(this).closest(".ap-subscribe").addClass("active")):(a(this).removeClass("active"),a(this).closest(".ap-subscribe").removeClass("active"))},this,function(){a(this).closest(".ap-subscribe").toggleClass("active")})})},vote:function(){a("body").delegate('[data-action="vote"] a',"click",function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){AnsPress.site.hideLoading(this);var c=a(this).parent();c.find(".ap-vote-fade").remove(),("undefined"!=typeof b.action&&"voted"==b.action||"undo"==b.action)&&("voted"==b.action?(a(this).addClass("voted"),"vote_up"==b.type&&c.find(".vote-down").addClass("disable"),"vote_down"==b.type&&c.find(".vote-up").addClass("disable"),a(this).trigger("voted",b)):"undo"==b.action&&(a(this).removeClass("voted"),"vote_up"==b.type&&c.find(".vote-down").removeClass("disable"),"vote_down"==b.type&&c.find(".vote-up").removeClass("disable"),a(this).trigger("undo_vote",b)),c.find(".net-vote-count").text(b.count))},this,!1)})},afterPostingAnswer:function(){a(document).on("ap_after_ajax",function(b,c){"undefined"!=typeof c.action&&"new_answer"==c.action&&(0===a("#answers").length?(a("#question").after(a(c.html)),a(c.div_id).hide()):a("#answers").append(a(c.html).hide()),a(c.div_id).slideDown(500))})},select_answer:function(){a("body").delegate('[data-action="select_answer"]',"click",function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(a){AnsPress.site.hideLoading(this)})})},ap_delete_post:function(){a("#anspress").delegate('[data-action="ap_delete_post"]',"click",function(b){b.preventDefault();var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){"undefined"!=typeof b.action&&"delete_answer"==b.action&&a(b.div_id).slideUp(500).fadeOut(300,function(){a(this).remove()})},this,!1)})},ap_upload_field:function(){a('[data-action="ap_upload_field"]').change(function(){a(this).closest("form").submit()}),a('[data-action="ap_upload_form"]').submit(function(){return a(this).ajaxSubmit({success:function(b){a("body").trigger("uploadForm",b)},url:ajaxurl,dataType:"json"}),!1})},change_status:function(){a("body").delegate('[data-action="ap_change_status"]',"click",function(b){b.preventDefault();var c=a(this).closest("ul").prev();AnsPress.site.showLoading(c);var d=a(this).attr("data-query");ApSite.doAjax(apAjaxData(d),function(a){AnsPress.site.hideLoading(c)},this,!1,!0)})},load_profile_field:function(){a("body").delegate('[data-action="ap_load_user_field_form"]',"click",function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(a){AnsPress.site.hideLoading(this)},this,!1)})},ap_post_upload_field:function(){a("body").on("click",'[data-action="ap_post_upload_field"]',function(b){b.preventDefault(),a('input[name="post_upload_image"]').trigger("click")}),a("body").delegate('[name="post_upload_image"]',"change",function(b){a("#hidden-post-upload").submit()}),a("body").delegate("#hidden-post-upload","submit",function(){var b=a('[data-action="ap_post_upload_field"]').closest(".ap-upload-o");return a(this).ajaxSubmit({beforeSubmit:function(){ApSite.showLoading(b)},success:function(c){ApSite.hideLoading(b),a("body").trigger("postUploadForm",c),"undefined"!=typeof c.html&&(ApSite.addImageInEditor(c.html),a(".ap-post-upload-form").append('<input type="hidden" name="attachment_ids[]" value="'+c.attachment_id+'" />'))},url:ajaxurl,dataType:"json",type:"POST"}),!1}),a("body").delegate('.ap-upload-remote-link, [data-action="post_image_close"]',"click",function(b){b.preventDefault(),a(".ap-upload-link-rc").toggle()}),a("body").delegate('[data-action="post_image_ok"]',"click",function(b){b.preventDefault(),a(".ap-upload-link-rc").toggle(),""!=a(this).prev().val()&&ApSite.addImageInEditor('<img src="'+a(this).prev().val()+'" />')})},addImageInEditor:function(b){"undefined"!=typeof tinyMCE?tinyMCE.activeEditor.execCommand("mceInsertContent",!1,b):a(".wp-editor-area").val(a(".wp-editor-area").val()+b)},previewLocalImage:function(a){if(a.files&&a.files[0]){var b=new FileReader;b.onload=function(a){ApSite.addImageInEditor('<img src="'+a.target.result+'" />')},b.readAsDataURL(a.files[0])}},tinyMCEeditorToggle:function(){a("body").delegate('[data-action="ap_fullscreen_toggle"]',"click",function(b){b.preventDefault(),a(this).toggleClass("active"),tinyMCE.activeEditor.execCommand("mceFullscreen")})},tab:function(){a("body").delegate(".ap-tab-nav a","click",function(b){b.preventDefault();var c=a(this).attr("href");a(".ap-tab-container > *").removeClass("active"),a(".ap-tab-nav >li").removeClass("active"),a(this).parent().addClass("active"),a(c).toggleClass("active")})},set_featured:function(){a("body").delegate('[data-action="set_featured"]',"click",function(b){b.preventDefault();var c=a(this).closest("ul").prev();AnsPress.site.showLoading(c);var d=a(this).attr("data-query");ApSite.doAjax(apAjaxData(d),function(a){AnsPress.site.hideLoading(c)},this,!1,!0)})},modal:function(){a("body").delegate('[data-action="ap_modal"]',"click",function(b){b.preventDefault();var c=a(a(this).data("toggle"));c.addClass("open");var d=c.find(".ap-modal-inner"),e=d.width(),f=d.height(),g=a(window).width(),h=a(window).height();d.css({left:(g-e)/2,top:h/2-f/2})}),a("body").delegate('[data-action="ap_modal_close"]',"click",function(b){a(".ap-modal").removeClass("open")})},expand:function(){a("body").delegate('[data-action="ap_expand"]',"click",function(b){b.preventDefault();var c=a(this).data("expand"),d=a(c).parent();a(d).animate({height:a(c).height()}),a(this).hide()})},follow:function(){a("body").delegate('[data-action="ap_follow"]',"click",function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){AnsPress.site.hideLoading(this),"follow"==b.action?a(this).addClass("active"):a(this).removeClass("active")},this,function(){a(this).toggleClass("active")})})},updateCover:function(){a(document).on("ap_after_ajax",function(b,c){"undefined"!=typeof c.action&&"cover_uploaded"===c.action&&a('[data-view="user_cover_'+c.user_id+'"]').css({"background-image":"url("+c.image+")"})})},hoverCard:function(){disable_hover_card||a('[data-action="ap_hover_card"]').tooltipster({theme:"ap-hover-card",delay:500,animation:"fade",interactive:!0,content:aplang.loading,functionBefore:function(b,c){c();var d=a(this).attr("data-query"),e=a(this).attr("data-userid");if(0==a("#user_"+e+"_card").length)a.ajax({type:"POST",url:ajaxurl,data:d+"&ap_ajax_nonce="+ap_nonce,success:function(c){a("body").append(c),b.tooltipster("content",a(c).show()),a(c).show()}});else{var f=a("#user_"+e+"_card").html();b.tooltipster("content",a(f).show())}}})},delete_notification:function(){a("body").delegate('[data-action="ap_delete_notification"]',"click",function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(b){AnsPress.site.hideLoading(this),"undefined"!=typeof b.container&&a(b.container).slideUp("400",function(){a(b.container).remove()})},this)})},mark_as_read:function(){a("body").delegate('[data-action="ap_markread_notification"]',"click",function(b){b.preventDefault(),AnsPress.site.showLoading(this);var c=a(this).attr("data-query");ApSite.doAjax(apAjaxData(c),function(a){AnsPress.site.hideLoading(this)},this)}),a(document).on("ap_after_ajax",function(b,c){"undefined"!=typeof c.action&&("mark_read_notification"===c.action?(a(c.container).removeClass("unread"),a(c.container).find(".ap-btn-markread").remove()):"mark_all_read"===c.action&&(a(".ap-notification-item").removeClass("unread"),a(".ap-notification-item").find(".ap-btn-markread").remove()))})},cancel_comment:function(){a("body").delegate('[data-action="cancel-comment"]',"click",function(b){b.preventDefault();var c=a(this).data("id");a('[href="#comments-'+c+'"]').removeClass("loaded"),a(this).closest(".ap-comment-form").remove()})}}}(jQuery),function(a){a(document).ajaxComplete(function(b,c,d){if("undefined"!=typeof c&&"undefined"!=typeof c.responseJSON&&"undefined"!=typeof c.responseJSON.ap_responce){var c=c.responseJSON;if("undefined"!=typeof c.message){var e="undefined"==typeof c.message_type?"success":c.message_type;ApSite.addMessage(c.message,e),"undefined"!=typeof grecaptcha&&"success"!==c.message_type&&grecaptcha.reset(widgetId1)}a(document).trigger("ap_after_ajax",c),"undefined"!=typeof c["do"]&&(a.isArray(c["do"])?a.each(c["do"],function(a,b){"function"==typeof ApSite[c["do"][a]]&&ApSite[c["do"][a]](c)}):"function"==typeof ApSite[c["do"]]&&ApSite[c["do"]](c)),"undefined"!=typeof c.view&&a.each(c.view,function(b,d){try{var e=a(d)}catch(f){console.log(f)}"undefined"!=typeof c.view_html&&"undefined"!=typeof e&&e.is('[data-view="'+b+'"]')?(e=e.children(),a('[data-view="'+b+'"]').html(e)):(a('[data-view="'+b+'"]').text(d),a('[data-view="'+b+'"]').removeClass("ap-view-count-0"))})}})}(jQuery);